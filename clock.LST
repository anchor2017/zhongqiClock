C51 COMPILER V9.56.0.0   CLOCK                                                             07/24/2017 14:13:02 PAGE 1   


C51 COMPILER V9.56.0.0, COMPILATION OF MODULE CLOCK
OBJECT MODULE PLACED IN clock.OBJ
COMPILER INVOKED BY: F:\keil51\C51\BIN\C51.EXE clock.c OPTIMIZE(9,SIZE) BROWSE DEBUG OBJECTEXTEND TABS(2)

line level    source

   1          /***************************************************************************************
   2           *  FileName          : clock.c
   3           *  CopyRight         :
   4           *  ModuleName        :
   5           *
   6           *  CPU             :
   7           *  RTOS            :
   8           *
   9           *  Create Data         : 2017.7.22
  10           *  Author/Corportation     : yezhihuo
  11           *
  12           *  Abstract Description    : 
  13           *
  14           *--------------------------------Revision History--------------------------------------
  15           *  No  version   Data      Revised By      Item      Description
  16           *
  17           *
  18           ***************************************************************************************/
  19          
  20          
  21          /**************************************************************
  22          * Debug switch Section 
  23          **************************************************************/
  24          
  25          
  26          /**************************************************************
  27          * Include File Section
  28          **************************************************************/
  29          #include"clock.h"
  30          /**************************************************************
  31          * Macro Define Section  
  32          **************************************************************/
  33          
  34          
  35          /**************************************************************
  36          * Struct Define Section
  37          **************************************************************/
  38          
  39          
  40          /**************************************************************
  41          * Prototype Declare Section  
  42          **************************************************************/
  43          
  44          
  45          /**************************************************************
  46          * Global Variable Declare Section
  47          **************************************************************/
  48          uchar sb;                     //每增加20次记录1s
  49          
  50          clockTime time;
  51          /**************************************************************
  52          * Function Define Section
  53          **************************************************************/
  54          
  55          /**
C51 COMPILER V9.56.0.0   CLOCK                                                             07/24/2017 14:13:02 PAGE 2   

  56          *  @name: void timeFun() 
  57          * @description: 中断服务特殊功能寄存器配置（定时器0初始化）
  58           *  @param    :none
  59           *  @return   : none
  60           *  @notice : 12MHZ
  61           */
  62          void initTimer()
  63          {
  64   1        TMOD=0x01;      //模式1
  65   1        TH0 = (65536 - 45872) / 256;
  66   1        TL0 = (65536 - 45872) % 256;   //0.05s
  67   1        ET0=1;     //开定时器
  68   1        TR0=1;     //开定时器中断
  69   1        EA=1;    //开总中断
  70   1      }
  71          
  72          /**
  73          *  @name: void timeFun() 
  74          * @description: 时钟计时
  75           *  @param    :none
  76           *  @return   : none
  77           *  @notice : 使用定时器0，程序运行期间始终运行
  78           */
  79          void timeFun() interrupt 1
  80          {
  81   1        TH0 = (65536 - 45872) / 256;
  82   1        TL0 = (65536 - 45872) % 256;   //0.05s
  83   1        if(sb >= 20 )             //20次为1s
  84   1        {
  85   2          sb = 0;
  86   2          if( time.second < 59 )         //60秒
  87   2          {
  88   3            time.second++;
  89   3          }
  90   2          else
  91   2          {
  92   3            time.second = 0;                    
  93   3            if( time.minute <59 )     //60分钟
  94   3            {
  95   4              time.minute++;
  96   4            }
  97   3            else
  98   3            {
  99   4              time.minute = 0;
 100   4              if( time.hour <23 )           ///1小时
 101   4              {
 102   5                time.hour++;
 103   5              }
 104   4              else
 105   4              {
 106   5                time.hour = 0;
 107   5              }
 108   4            }
 109   3          }      
 110   2        }
 111   1        else
 112   1        {
 113   2         sb++;
 114   2        }
 115   1      }


C51 COMPILER V9.56.0.0   CLOCK                                                             07/24/2017 14:13:02 PAGE 3   

MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     86    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      4    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
